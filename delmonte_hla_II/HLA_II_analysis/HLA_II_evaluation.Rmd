---
title: "HLA_II_evaluation"
author: "Fumin Li"
date: "`r Sys.Date()`"
output: html_document
---


# here test_pair_II means the test pairs for delmonte
```{r}
roc_emerson_test <- roc(emerson_test_II_2$class, emerson_test_II_2$score)
roc_emerson_test_df <- data.frame(
  FPR = 1-roc_emerson_test$specificities,
  TPR = roc_emerson_test$sensitivities
)
```

```{r}
roc_delmonte_test <- roc(test_pair_II$class, test_pair_II$score)
roc_delmonte_test_df <- data.frame(
  FPR = 1-roc_delmonte_test$specificities,
  TPR = roc_delmonte_test$sensitivities
)
```

```{r}
auc_delmonte <- roc_delmonte_test$auc
auc_emerson <- roc_emerson_test$auc
```

```{r}
ggplot() +
  geom_line(data = roc_delmonte_test_df, aes(x = FPR, y = TPR, color = "delmonte_auc"), size = 1.5) +
  geom_line(data = roc_emerson_test_df, aes(x = FPR, y = TPR, color = "emerson_auc"), size = 1.5) +
  geom_abline(slope = 1, intercept = 0, linetype = "dashed", size = 1.5) +
  scale_color_manual(values = c("delmonte_auc" = "purple",
                                "emerson_auc" = "blue"),
                     labels = c("delmonte_auc" = paste("delmonte: ", round(auc_delmonte, 2)),
                                "emerson_auc" = paste("emerson: ", round(auc_emerson, 2)))) +
  labs(title = "DePTH evaluation(HLA-II)",
       x = "FPR",
       y = "TPR") +
  theme_minimal() +
  theme(legend.position = c(1.11, 0.05), 
        legend.justification = c(1.25, 0), 
        legend.title = element_blank(),
        legend.background = element_rect(linetype = "solid", colour = "black"),
        legend.text = element_text(size = 15, face = "bold"),
        plot.title = element_text(size = 15, face = "bold"),
        axis.title = element_text(size = 15, face = "bold"),
        axis.text = element_text(size = 15, face = "bold"),
        legend.key.size = unit(1.5, 'lines')) + 
  coord_fixed()
```

